<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-epic_api/api-create">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">API - Create a new PID | European Persistent Identifier Consortium Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://doc.pidconsortium.eu/docs/epic_api/create"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="API - Create a new PID | European Persistent Identifier Consortium Documentation"><meta data-rh="true" name="description" content="This API uses JSON as the primary exchange format. All implementations MUST be able to produce and consume JSON."><meta data-rh="true" property="og:description" content="This API uses JSON as the primary exchange format. All implementations MUST be able to produce and consume JSON."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://doc.pidconsortium.eu/docs/epic_api/create"><link data-rh="true" rel="alternate" href="https://doc.pidconsortium.eu/docs/epic_api/create" hreflang="en"><link data-rh="true" rel="alternate" href="https://doc.pidconsortium.eu/docs/epic_api/create" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.bc029650.css">
<link rel="preload" href="/assets/js/runtime~main.0fffe95a.js" as="script">
<link rel="preload" href="/assets/js/main.3d3682df.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/ePIClogo.png" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/ePIClogo.png" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Persistent IDentifier Service</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/grnet/doc.pidconsortium.eu" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/epic-api">EPIC API</a><button aria-label="Toggle the collapsible sidebar category &#x27;EPIC API&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/epic_api/api">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/epic_api/auth">API - Basic Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/epic_api/generate">API - PID generation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/epic_api/get">API - Get a PID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/epic_api/list">API - List PID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/epic_api/search">API - Search a PID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/epic_api/create">API - Create a new PID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/epic_api/api-update">API - Update an existing PID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/epic_api/delete">API - Delete a PID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/epic_api/api-partial">API - Part Identifiers</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/handle-api-v90">Handle API v9.0</a><button aria-label="Toggle the collapsible sidebar category &#x27;Handle API v9.0&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/glossary">Glossary</a><button aria-label="Toggle the collapsible sidebar category &#x27;Glossary&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/epic-api"><span itemprop="name">EPIC API</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">API - Create a new PID</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>API - Create a new PID</h1></header><p>This API uses JSON as the primary exchange format. All implementations MUST be able to produce and consume JSON.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-new-pid---description">Create a new PID - Description<a class="hash-link" href="#create-a-new-pid---description" title="Direct link to heading">​</a></h2><p>You want to create a new PID. There are two ways to create - generate a new PID </p><ul><li>automatic generation of the suffix name via the POST method</li><li>manual generation of the suffix name via the PUT method</li></ul><p>HTTP PUT can be used for both resource creation and resource updates .
So if you want to be sure that you are going to create a new one you must first check if it exists. If you don&#x27;t check the existence of a PID based on the suffix it is possible that you will update the data of an existing one. </p><p>There is a way to make your HTTP PUT request “conditional” in the sense that it will only be executed if the URL doesn’t exist yet (which constitutes a create action), or that it does exist yet (which constitutes an update ). </p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>In order to make the PUT request conditional use HTTP’s If-Match: <em> or If-None-Match:</em> headers.</p></div></div><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><strong>Description</strong></td><td>Create a new PID</td></tr><tr><td><strong>URL</strong></td><td>The API Service URL</td></tr><tr><td><strong>HTTP Method</strong></td><td>PUT for manual generation of suffix name</td></tr><tr><td><strong>HTTP Method</strong></td><td>POST for automatic generation of suffix name</td></tr><tr><td><strong>Security</strong></td><td>Requires ownership of the PID. So you must authenticate before actually creating the PID</td></tr></tbody></table><p>The data you must send in order to create are described in the following table</p><table><thead><tr><th>Type</th><th>Description</th><th>Required</th><th>Default value</th><th>Example value</th></tr></thead><tbody><tr><td>suffix</td><td>The local name of the handle in the system</td><td>Yes</td><td>None</td><td>a) use a UUID generator via <strong>PUT method</strong>, b) automatic generation via <strong>POST method</strong></td></tr></tbody></table><p>The data you must send as json representation are described in the following table</p><table><thead><tr><th>Type</th><th>Description</th><th>Required</th><th>Default value</th><th>Example value</th></tr></thead><tbody><tr><td>type</td><td>Each handle has a set of values assigned to it.  These handle values use a common data structure for its data. The data type defines the syntax and semantics of the data in its data field.</td><td>Yes</td><td>None</td><td>URL</td></tr><tr><td>parsed_data</td><td>A set of data that describes the resource identified by the handle. The syntax and semantics of parsed data are identified by the field.</td><td>Yes</td><td>None</td><td><a href="http://www.grnet.gr" target="_blank" rel="noopener noreferrer">http://www.grnet.gr</a></td></tr><tr><td>timestamp</td><td>The timestamp records the last time this Handle Value was updated at the server. The field contains elapsed time since 00:00:00 UTC, January 1970 in milliseconds.</td><td>NO</td><td>timestamp</td><td>2013-11-26T11:58:14Z</td></tr><tr><td>ttl_type</td><td>the TTL type indicates whether the TTL value is absolute or relative.  The absolute TTL value defines the time to live in terms of seconds since 00:00:00 UTC, January 1st 1970.  A relative TTL specifies the time to live in terms of the number of seconds elapsed since the value was obtained by the client from any handle server.</td><td>NO</td><td>integer 0=relative, 1=absolute by default 0</td><td>0</td></tr><tr><td>ttl</td><td>a number that specifies the Time-To- Live of the value record. A positive value defines the time to live in terms of seconds since 00:00:00 UTC, January 1st 1970. A negative value specifies the time to live in terms of the number of seconds elapsed since the value was obtained. (if ttl_type is absolute, then this indicates the date/time of expiration in seconds since Jan 1 0:00:00 1970.)</td><td>NO</td><td>integer seconds</td><td>86400</td></tr><tr><td>refs</td><td>a list of references to other Handle Values</td><td>No</td><td>None</td><td>[{&#x27;idx&#x27;:&#x27;1&#x27;,&#x27;handle&#x27;:&#x27;11239/12&#x27;}]<!-- --> where idx is the value for index field of handle data, and handle is the referenced handle value</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a class="hash-link" href="#example" title="Direct link to heading">​</a></h2><p>In this example we are going to create a new handle via the PUT method  in the following url <a href="https://epic.grnet.gr/handles/11239/UUIDGENERATE" target="_blank" rel="noopener noreferrer">https://epic.grnet.gr/handles/11239/UUIDGENERATE</a>. There is an example via POST method at <a href="/docs/epic_api/generate">PID generation page</a></p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Curl</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Python</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">PHP</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Perl</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>The request in curl</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/bin/bash    </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">SUFFIX</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">uuidgen</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -v -u </span><span class="token string" style="color:#e3116c">&quot;YOURUSERNAME:YOURPASSWORD&quot;</span><span class="token plain"> -H </span><span class="token string" style="color:#e3116c">&quot;Accept:application/json&quot;</span><span class="token plain"> -H </span><span class="token string" style="color:#e3116c">&quot;Content-Type:application/json&quot;</span><span class="token plain"> -X PUT --data </span><span class="token string" style="color:#e3116c">&#x27;[{&quot;type&quot;:&quot;URL&quot;,&quot;parsed_data&quot;:&quot;http://www.grnet.gr/&quot;}]&#x27;</span><span class="token plain"> https://epic.grnet.gr/api/v2/handles/11239/</span><span class="token variable" style="color:#36acaa">$SUFFIX</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>The request in python</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> uuid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PIDSERVICE_URL</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;THE_SERVICE_URL_WITH_PREFIX&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PIDSERVICE_USER</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;YOURUSERNAME&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PIDSERVICE_PASSWD</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;YOURPASSWORD&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SUFFIX </span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">uuid1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">URL_TO_OPEN</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">PIDSERVICE_URL</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">SUFFIX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DATAURL</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># create a password manager</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password_mgr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">HTTPPasswordMgrWithDefaultRealm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Add the username and password.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password_mgr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_password</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PIDSERVICE_URL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PIDSERVICE_USER</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PIDSERVICE_PASSWD</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">handler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">HTTPBasicAuthHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">password_mgr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># create &quot;opener&quot; (OpenerDirector instance)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">opener </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build_opener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># use the opener to fetch a URL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">opener</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PIDSERVICE_URL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Install the opener.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Now all calls to urllib2.urlopen use the created opener.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">install_opener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">opener</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#create the json data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JSONDATA </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;type&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;URL&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;parsed_data&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;http://www.grnet.gr&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JSONDATATOSEND </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">JSONDATA</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REQUESTDATA </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">URL_TO_OPEN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">JSONDATATOSEND</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#create the headers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REQUESTDATA</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_header</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Content-Type&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;application/json&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REQUESTDATA</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_header</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Content-Length&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">JSONDATATOSEND</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># creates the PUT method</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REQUESTDATA</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_method </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;PUT&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DATAURL </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">urlopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">REQUESTDATA</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">URLError </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">code </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">404</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;404-Not found&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">code </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">401</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;401-Authentication failed&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">#get http code of the request</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> DATAURL</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Getting the code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;This gets the code: &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DATAURL</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>The request in php </p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$PIDSERVICE_URL=&quot;THE_SERVICE_URL_WITH_PREFIX&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$PIDSERVICE_USER=&quot;YOURUSERNAME&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$PIDSERVICE_PASSWD=&quot;YOURPASSWORD&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$UUID = gen_uuid(); //a function to generate a uuid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$URL_TO_OPEN = $PIDSERVICE_URL.$UUID;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$data = array(array(&#x27;type&#x27; =&gt; &#x27;URL&#x27;,&#x27;parsed_data&#x27;=&gt;&#x27;http://www.grnet.gr/&#x27;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$update_json=json_encode($data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Get cURL resource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ch = curl_init();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Set the headers to complete the request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl_setopt($ch, CURLOPT_HTTPHEADER, array(&#x27;Content-Type: application/json&#x27;,&#x27;Content-Length: &#x27; . strlen($update_json)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//set the PUT Action</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl_setopt($ch, CURLOPT_CUSTOMREQUEST, &quot;PUT&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//SET the postfield data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl_setopt($ch, CURLOPT_POSTFIELDS,$update_json);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Should cURL return or print out the data? (true = return, false = print)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Set the url with the new name of the PID </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl_setopt($ch, CURLOPT_URL, $URL_TO_OPEN);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Set the authentication options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl_setopt($ch, CURLOPT_USERPWD, $PIDSERVICE_USER.&quot;:&quot;.$PIDSERVICE_PASSWD);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$output = curl_exec($ch);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$info = curl_getinfo($ch);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Download the given URL, and return output </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if( $info[&#x27;http_code&#x27;]==200) echo &quot;HANDLE EXISTS&lt;br/&gt;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if( $info[&#x27;http_code&#x27;]==201) echo &quot;PID CREATED&lt;br/&gt;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if( $info[&#x27;http_code&#x27;]==204) echo &quot;PID UPDATED&lt;br/&gt;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if( $info[&#x27;http_code&#x27;]==404) echo &quot;HANDLE DOESNT EXIST&lt;br/&gt;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl_close($ch);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function gen_uuid() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return sprintf( &#x27;%04x%04x-%04x-%04x-%04x-%04x%04x%04x&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 32 bits for &quot;time_low&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mt_rand( 0, 0xffff ), mt_rand( 0, 0xffff ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 16 bits for &quot;time_mid&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mt_rand( 0, 0xffff ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 16 bits for &quot;time_hi_and_version&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // four most significant bits holds version number 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mt_rand( 0, 0x0fff ) | 0x4000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 16 bits, 8 bits for &quot;clk_seq_hi_res&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 8 bits for &quot;clk_seq_low&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // two most significant bits holds zero and one for variant DCE1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mt_rand( 0, 0x3fff ) | 0x8000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 48 bits for &quot;node&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mt_rand( 0, 0xffff ), mt_rand( 0, 0xffff ), mt_rand( 0, 0xffff )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>The request in perl</p><div class="language-perl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-perl codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/usr/bin/perl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use strict;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use warnings;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Data::Dumper;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Getopt::Long;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Switch &#x27;Perl5&#x27;, &#x27;Perl6&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use JSON;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use WWW::Curl::Easy;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">my $fullargv0 = $0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">my ($argv0) = $fullargv0 =~ /([^\/\\]+)$/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">my %settings = (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;debug&#x27; =&gt; &#x27;False&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;handle&#x27; =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;action&#x27; =&gt;&#x27;put&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;credentials&#x27;   =&gt;  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;username&#x27;  =&gt; &#x27;empty&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;password&#x27;  =&gt; &#x27;empty&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;baseuri&#x27;   =&gt; &#x27;empty&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;data&#x27;  =&gt;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;get&#x27;   =&gt; &#x27;&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;putpost&#x27;=&gt; &#x27;&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;format&#x27; =&gt; &#x27;none&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;headerextra&#x27;   =&gt; &#x27;&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;type&#x27; =&gt; &#x27;none&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;url&#x27;=&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;pid&#x27;=&gt; &#x27;ADD A PID&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Main subroutine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub main {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #Get the subroutine arguments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $settings_ref = shift;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Get the script arguments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (my $returncode) = get_arguments($settings_ref);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $returncode == 0 ) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         performPut($settings_ref);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return($returncode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Subroutine to perform a PUT action</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub performPut {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Get the subroutine arguments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $settings_ref = shift;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #construct url and headers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $url=&quot;$settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{baseuri}$settings_ref-&gt;{handle}-&gt;{url}-&gt;{pid}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;The constructed url is        : %s\n&quot;,$url) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my @httpHeaders = ( &#x27;Content-Type: application/json&#x27; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # add extra header info. f.i. &quot;If-Match: *&quot; or &quot;If-None-Match: *&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    push(@httpHeaders, &quot;$settings_ref-&gt;{handle}-&gt;{headerextra}&quot; ) if $settings_ref-&gt;{handle}-&gt;{headerextra} ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #construct data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $data=$settings_ref-&gt;{handle}-&gt;{data}-&gt;{putpost};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;The data is                   : %s\n&quot;,$data) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # perform action</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (my $returncode, my $response_code, my $response_content_type, my $response_body ) = httpPut($settings_ref, $url, \@httpHeaders, $data );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Looking at the results of the curl request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($returncode == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(&#x27;Transfer went ok\n&#x27;) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # judge result and next action based on $response_code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if ($response_code &gt;= 200 &amp;&amp; $response_code &lt; 300 ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            print(&#x27;The request went ok\n&#x27;) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            print(&#x27;The request went NOT ok\n&#x27;) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            print(&quot;$response_code\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(&#x27;An error happened\n&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># reader helper calback function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub read_callback {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my ($maxlength,$pointer)=@_;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # printf(&quot;The MAXLENGTH is     : \n&quot;, $maxlength);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # printf(&quot;The POINTER is       : \n&quot;, $$pointer) ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $data = $$pointer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $$pointer = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return $data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Subroutine to post data via a http PUT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub httpPut {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Get the subroutine arguments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $settings_ref = shift;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $url = shift;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $httpHeaders_ref = shift;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $data = shift;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;Entering httpPut              :\n&#x27;)         if $settings_ref-&gt;{debug} =~ /True/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # local varables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $length = length ($data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $body = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $header = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $response_body;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $response_code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $response_content_type;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $curl = WWW::Curl::Easy-&gt;new;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # set options for the curl http request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $curl-&gt;setopt(CURLOPT_HEADER, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $curl-&gt;setopt(CURLOPT_HTTPHEADER, $httpHeaders_ref );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $curl-&gt;setopt(CURLOPT_READFUNCTION, \&amp;read_callback);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $curl-&gt;setopt(CURLOPT_UPLOAD, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $curl-&gt;setopt(CURLOPT_INFILE, \$data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $curl-&gt;setopt(CURLOPT_INFILESIZE, length($data));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $curl-&gt;setopt(CURLOPT_URL, $url);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $curl-&gt;setopt(CURLOPT_USERNAME, $settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{username});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $curl-&gt;setopt(CURLOPT_PASSWORD, $settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{password});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #debugging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #$curl-&gt;setopt (CURLOPT_VERBOSE, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # A filehandle, reference to a scalar or reference to a typeglob can be used here.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    open my $fh, &#x27;&gt;&#x27;, \$response_body or die &quot;$!&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $curl-&gt;setopt(CURLOPT_WRITEDATA, $fh);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Do the actual curl http request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $returncode = $curl-&gt;perform;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # close file handle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    close($fh);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Looking at the results of the curl request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($returncode == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(&#x27;Transfer went ok\n&#x27;) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $response_code         = $curl-&gt;getinfo(CURLINFO_HTTP_CODE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $response_content_type = $curl-&gt;getinfo(CURLINFO_CONTENT_TYPE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(&quot;Received response code        : $response_code\n&quot;)         if $settings_ref-&gt;{debug} =~ /True/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(&quot;Received response content type: $response_content_type\n&quot;) if $settings_ref-&gt;{debug} =~ /True/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # judge result and next action based on $response_code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if ($response_code &gt;= 200 &amp;&amp; $response_code &lt; 300 ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            print(&#x27;The request went ok\n&#x27;) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            print(&quot;$response_body\n&quot;) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            print(&#x27;The request went NOT ok\n&#x27;) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            print(&quot;$response_code\n&quot;) if $settings_ref-&gt;{debug} =~ /True/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # Error code, type of error, error message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(&quot;An error happened: $returncode &quot;.$curl-&gt;strerror($returncode).&quot; &quot;.$curl-&gt;errbuf.&quot;\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Return the results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return($returncode, $response_code, $response_content_type, $response_body );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Subroutine to get and check all script arguments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub get_arguments {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Get the subroutine arguments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $settings_ref = shift;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Define local variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my %arguments;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $username;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $password;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $baseUri;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $pidUrl;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $credentials;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $handleData;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $type;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $header;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $returncode=0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my $message;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    my @sources;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GetOptions( &#x27;h|help&#x27;    =&gt; \$arguments{help},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;user=s&#x27;        =&gt; \$username,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;passwd=s&#x27;      =&gt; \$password,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;base=s&#x27;        =&gt; \$baseUri,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;pid=s&#x27;         =&gt; \$pidUrl,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;cred=s&#x27;        =&gt; \$credentials,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;data=s&#x27;        =&gt; \$handleData,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;type=s&#x27;        =&gt; \$type,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;header=s&#x27;      =&gt; \$header,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;get&#x27;           =&gt; \$arguments{get},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;put&#x27;           =&gt; \$arguments{put},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;delete&#x27;        =&gt; \$arguments{delete},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;post&#x27;          =&gt; \$arguments{post},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;pretty&#x27;        =&gt; \$arguments{pretty},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;d|debug&#x27;       =&gt; \$arguments{debug},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Check the help flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $arguments{help} ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # Set the returncode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $returncode=255;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $message = print_help();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Check the debug flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $arguments{debug} ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{debug} = &#x27;True&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&#x27;debug is                      : on\n&#x27;) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Check the pretty flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $arguments{pretty} ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{format} = &#x27;pretty&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&#x27;pretty format printing is     : on\n&#x27;) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Check the action flag&#x27;s (get,put,delete,post,search,nagios)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $arguments{get} ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{action} = &#x27;get&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The action is                 : %s\n&quot;, $settings_ref-&gt;{handle}-&gt;{action}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } elsif ( $arguments{put} ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{action} = &#x27;put&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The action is                 : %s\n&quot;, $settings_ref-&gt;{handle}-&gt;{action}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } elsif ( $arguments{delete} ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{action} = &#x27;delete&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The action is                 : %s\n&quot;, $settings_ref-&gt;{handle}-&gt;{action}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } elsif ( $arguments{post} ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{action} = &#x27;post&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The action is                 : %s\n&quot;, $settings_ref-&gt;{handle}-&gt;{action}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # check the username</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $username ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{username} = $username;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The username is               : %s\n&quot;,$settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{username}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # check the password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $password ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{password} = $password;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The password is               : %s\n&quot;,$settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{password}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # check the base uri</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $baseUri ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{baseuri} = $baseUri;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The base uri is               : %s\n&quot;,$settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{baseuri}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # check the pid url</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $pidUrl ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{url}-&gt;{pid} = $pidUrl;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The pid is                    : %s\n&quot;,$settings_ref-&gt;{handle}-&gt;{url}-&gt;{pid}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # check the handle data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $handleData ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{data}-&gt;{putpost} = $handleData;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The data is                   : %s\n&quot;,$settings_ref-&gt;{handle}-&gt;{data}-&gt;{putpost}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # check the type data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $type ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{type} = $type;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The type(s) to show is/are    : %s\n&quot;,$settings_ref-&gt;{handle}-&gt;{type}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # check the header data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $header ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{headerextra} = $header;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The extra header info is      : %s\n&quot;,$settings_ref-&gt;{handle}-&gt;{headerextra}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # check the credentials data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $credentials ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # read the credentials from the file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        my $filename = $credentials;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        my $json_text = do {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            open(my $json_fh, &quot;&lt;:encoding(UTF-8)&quot;, $filename)  or die(&quot;Can&#x27;t open $filename: $!\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            local $/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;$json_fh&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # convert from json and put in correct place </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        my $json = JSON-&gt;new;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $settings_ref-&gt;{handle}-&gt;{credentials} = $json-&gt;decode($json_text);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The username is               : %s\n&quot;,$settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{username}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The password is               : %s\n&quot;,$settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{password}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;The base uri is               : %s\n&quot;,$settings_ref-&gt;{handle}-&gt;{credentials}-&gt;{baseuri}) if $settings_ref-&gt;{debug} =~ /True/ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Print the message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if( $message ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print &quot;$message\n&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Return the results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return($returncode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-response">The response:<a class="hash-link" href="#the-response" title="Direct link to heading">​</a></h3><ul><li>HTTP/1.1 201 Created: (Success) </li><li>HTTP/1.1 204 No-Content: The local name already exists , and instead of creating a new one you’ve just updated the values of an existing one.  </li><li>HTTP/1.1 401 Unauthorized: Your username or your password is wrong</li><li>HTTP/1.1 405 Method Not Allowed: <ol><li>You are trying to create a new handle in the main url of the server either (<a href="https://epic.grnet.gr/handles/11239/" target="_blank" rel="noopener noreferrer">https://epic.grnet.gr/handles/11239/</a>) or (<a href="https://epic.grnet.gr/handles" target="_blank" rel="noopener noreferrer">https://epic.grnet.gr/handles</a>). You have not specified a unique name for your handle. (or)</li><li>You are trying to create a new handle with manual generation of suffix name via POST instead of PUT. POST supports automatic generation of suffix name.</li></ol></li><li>HTTP/1.1 412 Precondition failed: You have used the precondition (HTTP’s If-Match: <em> or If-None-Match:</em>) in the request-header fields. The precondition given, evaluated to false when it was tested on the server and prevented the requested method from being applied.</li><li>HTTP/1.1 415 Unsupported Media Type: You haven&#x27;t specify the correct headers for your request. The service supports Json representation so you must define the content-type of the request.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 201 Created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date: Mon, 25 Nov 2013 10:18:18 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Length: 2211</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Location: https://epic.grnet.gr/api/v2/handles/11239/05C3DB56-5692-11E3-AF8F-1C6F65A666B5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ETag: &quot;1B2M2Y8AsgTpgAmY7PhCfg&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Last-Modified: Thu, 01 Jan 1970 00:00:00 GMT</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/epic_api/search"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">API - Search a PID</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/epic_api/api-update"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">API - Update an existing PID</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#create-a-new-pid---description" class="table-of-contents__link toc-highlight">Create a new PID - Description</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"> </div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title"> </div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/grnet/doc.pidconsortium.eu" target="_blank" rel="noopener noreferrer" class="footer__link-item">Repo<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"> </div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/terms">Terms of Use</a></li><li class="footer__item"><a class="footer__link-item" href="/terms-greek">Terms of Use (in Greek)</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Persistent Identifiers for eResearch</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0fffe95a.js"></script>
<script src="/assets/js/main.3d3682df.js"></script>
</body>
</html>